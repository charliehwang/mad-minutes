<html>


<head>
	<title>MAD MINUTES</title>
	<link href="https://fonts.googleapis.com/css?family=Faster+One" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">
</head>


<style>

#wrapper {
	padding: 1em;
}

#logo {
	font-size: 200%;
	font-family: 'Faster One', cursive;
	/*border: 1px solid pink;*/
	color: #676767;
	color: #ec501f;
	padding-left: 0.5em;
}

.logoLighter {
	color: #bdbdbd;
	color: #ee7920;
}

.typeWrapper {
	font-family: 'Oswald', sans-serif;
	font-size: 130%;
	/*border: 1px solid red;*/
	margin-top: 1em;
}

.typeHeader {
	font-size: 130%;
	/*border: 1px solid red;*/
	padding: 0.5em 1em 0.5em 0em;
	color: #693610;
}

.setWrapper {

}

.set {
	float: left;
	padding: 1em;
	border: 1px solid #eaeaea;
	width: 2em;
	text-align: center;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(128, 128, 128, 0.1) inset;
    border-color: #dedede;
	transition: all 0.1s ease-in-out;

}

.set:hover {
    box-shadow: 0 1px 4px rgba(238, 120, 32, 0.3), 0 0 24px rgba(238, 105, 31, 0.4) inset;
    border-color: #ee7820;
    text-shadow: 0 0 8px #ed5421;
    color: #b32800;
}

.mult {
	font-size: 150%;
	/*border: 1px solid pink;*/
	float: left;
	width: 3em;
	height: 3em;
	padding-top: 1em;
	padding-right: 1em;
	padding-bottom: 2em;
}
.symbol {
    padding-top: 1.9em;
    padding-left: 0.2em;
    padding-right: 0.2em;
	color: #737373;
}
.leftSide {
	/*border: 1px solid red;*/
	float: right;
	height: 3em;
	border-bottom: 1px solid #afafaf;
}
.rightSide {
	/*border: 1px solid blue;*/
	float: right;
	height: 3em;
	border-bottom: 1px solid #afafaf;
}

.top {
	/*border: 1px solid green;*/
	padding-bottom: 0.3em;
}
.bottom {
	/*border: 1px solid orange;*/
}

.inputArea input {
	font-size: 82%;
	text-align: right;
	float: right;
	width: 3em;
	height: 2em;
	border: 2px solid #eaeaea;
    border-radius: 5px;
    right: -0.2em;
    padding-left: 0.2em;
    padding-right: 0.2em;
    position: relative;
    color: #947b2f;
}

.inputArea input:focus {
    outline: none;
    border-color: #9ecaed;
    box-shadow: 0 0 7px #9ecaed;
}

.product {
	text-align: right;
}

.productFirstNum {
    padding-top: 0.7em;
}

.productSecNum {

}

.clearer { clear: both; }
</style>



<script>
data = {
	"Multiplication" : {
			"A" : [ 
					[1,5], [2,7], [0,7], [4,6], [9,8], [9,7], [7,7], [5,6], [3,8], [4,2],
					[3,2], [0,6], [5,3], [2,4], [6,4], [3,5], [8,4], [3,7], [7,4], [5,4],
					[6,2], [8,9], [5,2], [6,7], [2,3], [4,8], [4,5], [3,5], [5,8], [4,4],
					[8,7], [7,2], [9,6], [6,5], [8,3], [7,6], [5,9], [2,6], [6,2], [3,9],
				  ],
			"B" : [ 
					[1,5], [2,7], [0,7], [4,6], [9,8], [9,7], [7,7], [5,6], [3,8], [4,2],
					[3,2], [0,6], [5,3], [2,4], [6,4], [3,5], [8,4], [3,7], [7,4], [5,4],
					[6,2], [8,9], [5,2], [6,7], [2,3], [4,8], [4,5], [3,5], [5,8], [4,4],
					[8,7], [7,2], [9,6], [6,5], [8,3], [7,6], [5,9], [2,6], [6,2], [3,9],
				  ],
			"C" : [ 
					[1,5], [2,7], [0,7], [4,6], [9,8], [9,7], [7,7], [5,6], [3,8], [4,2],
					[3,2], [0,6], [5,3], [2,4], [6,4], [3,5], [8,4], [3,7], [7,4], [5,4],
					[6,2], [8,9], [5,2], [6,7], [2,3], [4,8], [4,5], [3,5], [5,8], [4,4],
					[8,7], [7,2], [9,6], [6,5], [8,3], [7,6], [5,9], [2,6], [6,2], [3,9],
				  ],
			"D" : [ 
					[1,5], [2,7], [0,7], [4,6], [9,8], [9,7], [7,7], [5,6], [3,8], [4,2],
					[3,2], [0,6], [5,3], [2,4], [6,4], [3,5], [8,4], [3,7], [7,4], [5,4],
					[6,2], [8,9], [5,2], [6,7], [2,3], [4,8], [4,5], [3,5], [5,8], [4,4],
					[8,7], [7,2], [9,6], [6,5], [8,3], [7,6], [5,9], [2,6], [6,2], [3,9],
				  ],
			"E" : [ 
				  ],
			"F" : [ 
				  ],
			"G" : [ 
				  ],
			"H" : [ 
				  ],
			"I" : [ 
				  ],
			"J" : [ 
				  ],
			"K" : [ 
				  ],
			"L" : [ 
				  ],
			"M" : [ 
				  ],
			"N" : [ 
				  ],
			"O" : [ 
				  ],
			"P" : [ 
				  ],
			"Q" : [ 
				  ],
			"R" : [ 
				  ],
			"S" : [ 
				  ],
			"T" : [ 
				  ],
			"U" : [ 
				  ],
			"V" : [ 
				  ],
			"W" : [ 
				  ],
			"X" : [ 
				  ],
			"50 A" : [ 
				     ],
			"50 B" : [ 
				     ],
	},
	"Division" : {
			"A" : [ 
				  ],
			"B" : [ 
				  ],
			"C" : [ 
				  ],
			"D" : [ 
				  ],
			"E" : [ 
				  ],
			"F" : [ 
				  ],
			"G" : [ 
				  ],
			"H" : [ 
				  ],
			"I" : [ 
				  ],
			"J" : [ 
				  ],
			"K" : [ 
					[7,63], [5,25], [1,3], [4,16], [9,63], [2,12], [6,54], [1,4], [9,27], [9,45],
					[9,36], [7,14], [4,8], [9,63], [3,27], [5,10], [5,45], [5,25], [2,10], [9,63],
					[9,45], [3,9], [9,54], [7,7], [2,8], [5,25], [7,63], [6,12], [9,36], [1,2],
					[4,16], [2,10], [5,25], [7,63], [1,3], [3,6], [2,18], [3,9], [9,54], [7,14],
				  ],
	},
};

document.addEventListener('keydown', function(e) {
	var leftArrowKey = 37;
	var rightArrowKey = 39;
	var upArrowKey = 38;
	var dnArrowKey = 40;
	var delKey = 8;
	var enterKey = 13;
	var spaceKey = 32;
    console.log('keydown:' + e.keyCode);

    var el = e.target;
    var id = el.id;

    if (e.keyCode == delKey) {
    	e.preventDefault();
    	el.value = "";	
        return false;
    }

    if (e.keyCode == enterKey) {
    	e.preventDefault();
		focusOnNextInput(id);
        return false;
    }

    if (e.keyCode == spaceKey) {
    	e.preventDefault();
		focusOnNextInput(id);
        return false;
    }

    // if key is an arrow key, don't type the user
    // input. 
    if (e.keyCode > 36 && e.keyCode < 41) {
    	e.preventDefault();

    	if (e.keyCode == rightArrowKey || e.keyCode == upArrowKey)
    		focusOnNextInput(id);
    	if (e.keyCode == leftArrowKey || e.keyCode == dnArrowKey)
    		focusOnPrevInput(id);

        return false;
    }


});




function setup() {
	// var el = document.getElementById('foo');
	// el.innerHTML = 'Hello World!';


	outputSets();


	var type = "Multiplication";
	var set = "W";

	// var problems = getProblemsForTypeAndSet(type, set);
	// outputProblems(type, problems);
	// focusOnFirstProblem();


}

function outputSets() {
	var type = Object.keys(data);

	var el = document.getElementById('mathContent');
		el.innerHTML = "";

	var html = "";
	type.forEach( function(type, i) {
		var sets = Object.keys(data[type]);

		html += "<div class='typeWrapper'>\
					<div class='typeHeader'>"
						+ type +
					"</div>";

					html += "<div class='setWrapper'>";
						sets.forEach( function (set, i) {
							html += "<div class='set' onClick='setupProblemsForTypeAndSet(\"" + type + "\",\"" + set + "\");'>" + set + "</div>";
						});
					html += "</div>";

					html += "<div class='clearer'></div>";
		html += "</div>";
	});

	el.innerHTML = html;
}

// https://stackoverflow.com/questions/469357/html-text-input-allows-only-numeric-input
function validate(evt) {
  var theEvent = evt || window.event;
  var key = theEvent.keyCode || theEvent.which;
  key = String.fromCharCode( key );
  var regex = /[0-9]|\./;
  if( !regex.test(key) ) {
    theEvent.returnValue = false;
    if(theEvent.preventDefault) theEvent.preventDefault();
  }
}


function focusOnFirstProblem() {
	var firstProb = document.getElementById("answer_0");
	firstProb.focus();
}

function focusOnNextInput(id) {
	var idx = getIdxFromInputID(id);
	var incremented = parseInt(idx) + 1; 

	var nextEL = document.getElementById("answer_" + incremented);
	nextEL.focus();
}

function focusOnPrevInput(id) {
	var idx = getIdxFromInputID(id);
	var decremented = parseInt(idx) - 1; 

	var nextEL = document.getElementById("answer_" + decremented);
	nextEL.focus();
}

function adjustIDX(idx) {
	
}

function getIdxFromInputID(id) {
	var re = /answer_(\d+)/;
	var results = id.match(re);

	var idx = results[1];
	return idx;
}

function setupProblemsForTypeAndSet(type, set) {
	var problems = getProblemsForTypeAndSet(type, set);
	outputProblems(type, problems);
}

function outputProblems(type, problems) {
	var el = document.getElementById('mathContent');
		el.innerHTML = "";

	problems.forEach( function (prob, i) {
		var html = htmlForType(type, prob, i);

		el.innerHTML += html;
	});
	focusOnFirstProblem();
}


function htmlForType(type, prob, idx) {
	var firstNum = prob[0];
	var secNum = prob[1];

	var html = "";
	switch(type) {
	    case 'Multiplication':
	    	html = "<div class='mult'>\
	    				<div class='top'>\
		    				<div class='rightSide'>\
			    				<div class='product productFirstNum'>"
			    				+ firstNum + 
			    				"</div>\
			    				<div class='product productSecNum'>"
			    				+ secNum + 
			    				"</div>\
			    			</div>\
		    				<div class='leftSide'>\
		    					<div class='symbol'>\
			    					&times;\
			    				</div>\
		    				</div>\
			    			<div class='clearer'></div>\
		    			</div>\
	    				<div class='bottom'>\
		    				<div class='inputArea'>\
		    					<input type='text' class='answers' id='answer_"
		    					+ idx +
		    					"' onKeyPress='validate(event);'></input>\
			    			</div>\
			    			<div class='clearer'></div>\
		    			</div>\
	    			</div>";
	        break;
	    case 'Division':
	        break;
	    default:
	}

	return html;
}


function getProblemsForTypeAndSet(type, set) {
	var problems = data[type][set];

	if (!problems) 
		console.log("[ERROR] Could not find problems for " + type + " set: " + set);

	return problems;
}



</script>


<body onLoad="setup();">
	<div id="wrapper">
		<div id="banner">
			<!-- <div id="logo">MM</div> -->
			<div id="logo">MAD<span class="logoLighter">MINUTES<span></div>
		</div>
		<div id="mathContent"></div>
	</div>
</body>


</html>
